---
title: "Final Project"
author: "Aldrin Carbonell, Johnny Nguyen, Andy Tseng, Samuel Perng, Justin Choi"
date: "March 6, 2019"
output: html_document
---
```{r}
library(rgdal)
library(sp)
library(leaflet)
library(raster)
library(tmap)
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

#loading in the data and cutting it to the columns we need 
ethnicity2009 <-read.csv(file="2009_Ethnicity/ACS_09_5YR_B02001_with_ann.csv", header=TRUE, sep=",")
ethnicity2009 <- ethnicity2009[-1,c("GEO.id", "GEO.id2","HD01_VD01","HD01_VD02")]

ethnicity2017<-read.csv(file="2017_Ethnicity/ACS_17_5YR_B02001_with_ann.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
ethnicity2017 <- ethnicity2017[-1,c("GEO.id", "GEO.id2","HD01_VD01","HD01_VD02")]

ethnicty <- merge(ethnicity2017, ethnicity2009, by.x='GEO.id2',by.y='GEO.id2')



```

```{r}
#loading in king county census tract
KC_shape <- shapefile("king10ct/king10ct.shp")

#merge king county shapefile with population data
KC_shape_merged <- merge(KC_shape,ethnicity2017,by.x='GEOID10'
                         , by.y='GEO.id2')
```


```{r}
#get range for data
population <- as.numeric(KC_shape_merged$HD01_VD02)
#bins <- quantile(population, probs = c(0.25, 0.50, .75,1))
bins <- quantile(population)
#create color pallete 
pal <- colorBin("YlOrRd", domain = KC_shape_merged$HD01_VD02, bins = bins)

#labels for leaflet
labels <- sprintf(
  "<strong>%s</strong><br/>Population White: %s people<sup></sup>",
  KC_shape_merged$NAMELSAD10, KC_shape_merged$HD01_VD02
) %>% lapply(htmltools::HTML)


#change projection of shapefile to work with leaflet
PRO <- sp::CRS('+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0')
KC_shape_merged <- sp::spTransform(KC_shape_merged,PRO)

#leaflet map
leaflet(KC_shape_merged) %>% 
  addTiles() %>% addProviderTiles(providers$OpenStreetMap) %>% 
  addPolygons(fill = TRUE, fillColor = ~pal(as.numeric(KC_shape_merged$HD01_VD02)),  
  weight = 1,
  opacity = 1,
  color = "white",
  fillOpacity = 0.7,
  label = labels)
```

# Gentrification of King County, Washington: 2009 & 2017

